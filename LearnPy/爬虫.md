[TOC]

# 爬虫

## requests库

### 请求

#### get请求

基本写法

```python
import requests

response = reqursts.get('http://httpbin/get')

print(response.text)
```

带参数的 get请求

```python
import requests
#第一种方法
response1 = reqursts.get('http://httpbin/get?name=germey&age=22')
#第二种方法
data = {'name':'germey',
        'age' : 22
       }
response2 = response = reqursts.get('http://httpbin/get',params=data)

print(resoponse1,response2)
```

#### 解析json

```python
#第一种方式
import requests
response1 = requests.get('http://httpbin/get')
print(response.json())
#第二种方式
import requests
import json
response2 = requests.get('http://httpbin/get')
print(json.load(response.text))
```

#### 获取二进制数据（如图片、视频）

```python
import requests
resopnse = requests.get('https://github.com/favicon.ico')
#print(type(response.text),type(response.content))
with open('favicon.ico','wb') as f:
    f.write(response.content)
```



#### 添加headers

```python
import requests
headers = {
    User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36
}
response = requests.get('https://www.zhihu.com/explore',headers = headers)
print(response.text)
```

#### 基本post请求

```python
import requests
data = {
    'name':'germey',
    'age':22
}
headers = {
    User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36
}
response = request.post("http://httpbin.org/post",data = data, headers = headers)
print(response.text)
print(response.json())
```

### 响应

##### response属性

```python
import requests
response = requests.get("http://www.jianshu.com")
print(type(response.status_code),response.status_code)
print(type(response.headers),response.headers)
print(type(response.cookies),response.cookies)
print(type(response.url),response.url)
print(type(response.history),response.history)
```

##### 状态码判断
```python
import requests
response = requests.get("http://www.jianshu.com")
exit() if not response.status_code == requests.codes.ok else print("Requests Successfully")
exit() if not response.statue_code == 200 else print("Requests Successfully")
```

##### 文件上传
```python
import requests
files = {
    'file':open('favicon.ico,'rb')
}
response = requests.get("http://http.org/post",files = files)
print(response.text)
```

##### 获取cookie

```python
import requests
response = requests.get('https：//www.baidu,com')
print(responses.cookies)
for key, value in response.cookies.items():
    print(key+'='value)
```

##### 会话持续

```python
import requests 

s = requests.Session()
s.get('http://httpbin.org/cookies/set/number/123456789')
response = s.get("http://httpbin.org/cookies")
print(response.text)
```

##### 证书验证


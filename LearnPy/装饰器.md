#### 装饰器

装饰器： 本质就是函数，功能是为其他函数添加附加功能

#### 原则：  

1. 不修改被修饰函数的源代码
2. 不修改被装饰函数的调用方法

装饰器 = 高阶函数+函数嵌套+闭包

##### 高阶函数

###### 定义

1. 函数的参数是一个函数名
2. 函数的返回值是一个函数名
3. 满足上述条件中任意一个的函数都能被称为高阶函数

```python
import time
def foo():
    time.sleep(2)
    print('hello world')

def text(func):
    return func

text(foo)()
#改变了函数的调用方式，没有满足装饰器的条件
def text2(func):
    start_time = time.time()
    func()
    stop_time = time.time()
    print('函数运行时间%s' %(stop_time - start_time))



text2(foo)
#多运行了一次，没有满足装饰器的条件
def test3(func):
    start_time = time.time()
    func()
    stop_time = time.time()
    print('函数运行时间%s' % (stop_time - start_time))
    return func

foo = test3(foo)
foo()
```

###### 函数嵌套

```python
def grandson(name):
    print("your grandson is %s" %name)
    def father():
        name = "Lement"
        print("your father is %s" %name)

        def son():
            name = 'micheal'
            print("your son is %s" % name)

        son()
    father()


grandson("raymond")
```

#### 装饰器

##### 无参数的装饰器

```python
import time
def stime(func):
    def wapper():
        start = time.time()
        func()
        stop = time.time()
        print(stop - start)
    return wapper
@stime
def helloworld():
    print('helloworld')

helloworld()
```

##### 有返回值的装饰器

```python
import time
def stime(func):
    def wapper():
        start = time.time()
        res = func()#与上一个的区别
        stop = time.time()
        print(stop - start)
        return res#与上一个的区别
    return wapper
@stime #helloworld = stime(helloworld)
def helloworld():
    print('helloworld')

helloworld()
```



##### 参数的装饰器

```python
import time
def stime(func):
    def wapper(*args,**kwargs):
        start = time.time()
        res = func(*args,**kwargs)#与上一个的区别
        stop = time.time()
        print(stop - start)
        return res#与上一个的区别
    return wapper
@stime
def helloworld(name):
    print(name)
    print('helloworld')
    return name.upper()

helloworld('alxe')
```

##### 为函数添加验证是否登陆的装饰器

```python
user_list = [
    {'name':'alxa','passwd':'123'},
    {'name':'micheal','passwd':'564'},
    {'name':'join','passwd':'789'}
]

logined_list = {'name':'None','login':None}
def loging_confire(func):
    def wapper(*args,**kwargs):
        if logined_list['login']:
            res = func(*args,**kwargs)
            return res
        else:
            username = input('please input your username')
            passwd = input('please input your user name')
            for name_dict in user_list:
                if username == name_dict['name'] and passwd == name_dict['passwd']:
                    logined_list['name'] = username.strip()
                    logined_list['login'] = passwd
                    res = func(*args,**kwargs)
                    return res
            else:
                print('your name or password is error, please try again later')
    return wapper


@loging_confire
def home():
    print("this is your home page")

    
@loging_confire
def index():
    print("this is your index page")

    
print('before',logined_list)
home()
print('after',logined_list)
index()
```

#### 解压序列

```python
#快速赋值
a,b,c = (1,2,3)
print(a,b,c)
#不用索引取列表的第一个和最后一个值
l = [1,2,3,4,5,6,7,54,87,45,32,27,67,86,34,25,57,89]
a,*_,d = l
print(a,d)
#交换a，b两个变量的值
a,b = b,a

```



